---
name: proj-task
description: 创建、更新、查看全流程任务文档。用于需求开始时初始化任务文档、方案确认后拆分任务清单、开发过程中维护状态与产物。
---

# 任务管理

## 核心规范

### 文档生成原则
- **必须按模板格式生成**：严格遵循模板，不能仅凭内容完整性判断
- **支持中断恢复**：任务状态清晰，对话中断后能快速恢复进度
- **全流程主线**：记录流程状态、产物清单、上下文快照、下一步指令
- **实时状态更新**：任务进展时及时更新状态标记

## 任务文档位置

```
docs/task/{YYYYMMDD}_{中文模块名}_任务.md
```

---

## 任务文档格式

**必须使用模板**：[任务文档模板](templates/task-doc.md)

**关键要素**：
- 流程状态总览与阶段状态
- 产物清单（路径或未生成）
- 上下文快照与下一步指令
- 可跟踪的任务状态标记与分阶段任务清单
- 提交记录与历史任务归档

---

## 任务状态标记

| 标记 | 状态 | 说明 |
|------|------|------|
| `[ ]` | 待处理 | 未开始 |
| `[~]` | 进行中 | 正在开发 |
| `[x]` | 已完成 | 开发完成 |
| `[!]` | 阻塞 | 有问题待解决 |
| `[-]` | 取消 | 不再需要 |

---

## 操作指令

### 初始化任务文档（需求开始）

**触发：** 用户首次输入需求

**要求：**
- 创建全流程任务文档骨架
- 只填写流程状态、产物清单、上下文快照、下一步指令
- 不写技术细节

### 创建/补充任务清单

**触发：** 方案确认后

**标准任务顺序：** 参考 [任务文档模板](templates/task-doc.md)

### 更新任务状态

**状态变更规则**：
- 开始任务前：`[ ]` → `[~]`
- 完成任务后：`[~]` → `[x]`
- 遇到阻塞：`[~]` → `[!]` 并说明原因
- 任务取消：`[ ]` → `[-]`

**重要原则**：
- 同一时间只有一个任务为 `[~]`
- 完成任务后立即更新状态
- 代码提交后及时记录commit信息
- 同步更新流程状态、产物清单、上下文快照、下一步指令

### 查看任务进度

**汇报格式**：
```
当前功能：{中文模块名}
整体进度：{已完成}/{总数}
当前阶段：{阶段名称}
当前状态：
- [x] 已完成任务1
- [~] 进行中任务2
- [ ] 待处理任务3
下一步指令：{下一动作}
```

### 任务归档

功能开发完成后：
1. 将整个任务块从「当前任务」移动到「历史任务」
2. 记录完成时间和最终提交记录
3. 为新功能创建新的任务文档

---

## 质量检查

### 文档生成检查
- [ ] 是否按照模板格式生成
- [ ] 是否包含流程状态总览与产物清单
- [ ] 是否包含上下文快照与下一步指令
- [ ] 任务状态是否可跟踪（使用 `[ ]` `[~]` `[x]` 标记）
- [ ] 是否包含标准阶段任务清单
- [ ] 是否支持中断恢复

### 使用过程检查
- [ ] 状态更新是否及时
- [ ] 提交记录是否完整
- [ ] 同时只有一个任务为进行中
- [ ] 完成的任务是否及时归档
