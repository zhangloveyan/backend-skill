---
name: proj-change
description: 处理开发过程中的需求变更。用于开发过程中需求有调整、需要新增/删除/修改功能点、方案确认后发现遗漏。
---

# 需求变更

## 触发词

- "需求变了"
- "再加个字段"
- "这个不要了"
- "改一下"

---

## 执行流程

```
Step 1: 记录变更 → Step 2: 评估影响 → Step 3: 确认变更 → Step 4: 更新文档 → Step 5: 继续开发
```

---

## Step 1: 记录变更

```markdown
## 变更记录

**变更类型：** 新增 / 修改 / 删除
**变更描述：** {具体描述}
**变更原因：** {为什么要改}
```

---

## Step 2: 评估影响

```markdown
## 影响分析

**影响范围：**
- [ ] 数据库表结构
- [ ] Entity 实体类
- [ ] Mapper
- [ ] Service
- [ ] DTO
- [ ] Controller

**影响文件：**
- 需修改：{文件列表}
- 需新增：{文件列表}
- 需删除：{文件列表}

**风险评估：**
- 是否影响已有数据：是/否
- 是否影响其他功能：是/否
```

---

## Step 3: 确认变更

向用户确认：
- 变更内容
- 影响范围
- 注意事项

---

## Step 4: 更新文档

### 更新方案文档（如有）

```markdown
## 变更记录

| 日期 | 变更内容 | 原因 |
|------|----------|------|
| 2025-01-15 | 新增 phone 字段 | 需要记录手机号 |
```

### 更新任务文档

```markdown
- [ ] [变更] 新增 phone 字段到 user 表
- [ ] [变更] User 实体添加 phone 属性
```

---

## 常见变更影响

| 变更类型 | 影响范围 |
|----------|----------|
| 加字段 | 表结构、Entity、DTO |
| 改字段类型 | 表结构、Entity、DTO、Service |
| 加接口 | Service、Controller、可能需要新 DTO |
| 删功能 | 可能涉及多层代码删除 |

---

## 注意事项

1. **先评估后执行** - 不要直接改代码
2. **记录变更历史** - 在方案文档中记录
3. **更新任务列表** - 变更产生的任务要加入列表
4. **标记变更任务** - 用 `[变更]` 前缀标识
5. **注意数据兼容** - 涉及数据库的变更要考虑已有数据
